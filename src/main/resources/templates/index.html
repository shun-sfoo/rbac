<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>SpringBoot and easyui RBAC</title>
    <link rel="stylesheet" href="easyui/themes/bootstrap/easyui.css">
    <link rel="stylesheet" href="easyui/themes/icon.css">
    <link rel="stylesheet" href="css/app.css">
    <script src="easyui/jquery.min.js"></script>
    <script src="easyui/jquery.easyui.min.js"></script>
    <script src="easyui/locale/easyui-lang-zh_CN.js"></script>
    <script>
        $(function () {
            $.fn.tree.defaults.loadFilter = function (data, parent) {
                let opt = $(this).data().tree.options;
                let idField, textFiled, parentFiled;
                if (opt.parentField) {
                    idField = opt.idField || 'id';
                    textFiled = opt.textField || 'text';
                    parentFiled = opt.parentField;
                    let i, l, treeData = [], tmpMap = [];

                    for (i = 0, l = data.length; i < l; i++) {
                        tmpMap[data[i][idField]] = data[i];
                    }
                    for (i = 0, l = data.length; i < l; i++) {
                        if (tmpMap[data[i][parentFiled]] && data[i][idField] != data[i][parentFiled]) {
                            if (!tmpMap[data[i][parentFiled]]['children'])
                                tmpMap[data[i][parentFiled]]['children'] = [];
                            data[i]['text'] = data[i][textFiled];
                            tmpMap[data[i][parentFiled]]['children'].push(data[i]);
                        } else {
                            data[i]['text'] = data[i][textFiled];
                            treeData.push(data[i]);
                        }
                    }
                    return treeData;
                }
                return data;
            };

            let menuTree = $("#menuTree");
            let center = $("body").layout("panel", "center");
            menuTree.tree({
                url: 'menus',
                parentField: 'parentId',
                onSelect: function (node) {
                    center.panel('refresh', node.href).panel('setTitle', node.text);
                }
            });
        });
    </script>
</head>
<body class="easyui-layout">
<div data-options="region:'north'" class="header">
    <h1 class="title">Spring boot and easyui rbac2</h1>
    <div class="info">
        <a th:text="${session.user.userName}">管理员</a>
        <a href="logout">注销</a>
    </div>
</div>

<div data-options="region:'west'" title="导航" style="width: 150px">
    <ul id="menuTree"></ul>
</div>

<div data-options="region:'center'" title="控制台">
</div>

<div data-options="region:'south'" class="footer">
    xxxxxx
</div>

</body>
</html>